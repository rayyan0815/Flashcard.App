<!-- DOCTYPE tells the browser this is an HTML5 document -->
<!DOCTYPE html>

<!-- <html> is the root element that contains everything -->
<!-- lang="en" tells browsers the language is English -->
<html lang="en">

<!-- <head> contains metadata - info ABOUT the page, not shown on the page -->
<head>
    <!-- charset=UTF-8 allows special characters like emojis -->
    <meta charset="UTF-8">
    
    <!-- Makes the website responsive on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- The title that appears in the browser tab -->
    <title>Flashcard App</title>
    
    <!-- <style> contains CSS - this controls how everything LOOKS -->
    <style>
        /* * selector means "apply to ALL elements" */
        * {
            margin: 0;        /* Remove default spacing outside elements */
            padding: 0;       /* Remove default spacing inside elements */
            box-sizing: border-box;  /* Makes width/height calculations easier */
        }

        /* Style the <body> element (the whole page) */
        body {
            /* Font for all text on the page */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            
            /* Linear gradient makes a color fade from purple to darker purple */
            /* 135deg is the angle of the gradient */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            
            /* min-height: 100vh means "at least as tall as the screen" */
            min-height: 100vh;
            
            /* Add 20px of spacing inside the body edges */
            padding: 20px;
        }

        /* Style elements with class="container" */
        .container {
            max-width: 800px;      /* Don't get wider than 800px */
            margin: 0 auto;        /* Center it horizontally (0 top/bottom, auto left/right) */
        }

        /* Style all <h1> heading elements */
        h1 {
            text-align: center;    /* Center the text */
            color: white;          /* White text color */
            font-size: 2.5em;      /* 2.5 times the normal font size */
            margin-bottom: 30px;   /* Space below the heading */
            
            /* text-shadow adds a shadow: x-offset y-offset blur color */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* Style elements with class="top-buttons" */
        .top-buttons {
            display: flex;         /* Use flexbox layout - makes items sit in a row */
            gap: 15px;            /* 15px space between items */
            justify-content: center;  /* Center items horizontally */
            margin-bottom: 30px;   /* Space below this section */
        }

        /* Style ALL <button> elements */
        button {
            padding: 12px 30px;    /* Space inside button (top/bottom left/right) */
            font-size: 16px;       /* Text size */
            border: none;          /* Remove default border */
            border-radius: 25px;   /* Round the corners (higher = rounder) */
            cursor: pointer;       /* Show hand cursor when hovering */
            
            /* transition makes changes smooth over 0.3 seconds */
            transition: all 0.3s;
            
            font-weight: 600;      /* Make text bold (600 is semi-bold) */
        }

        /* Style buttons with class="btn-primary" */
        .btn-primary {
            background: white;     /* White background */
            color: #667eea;       /* Purple text */
        }

        /* :hover means "when mouse is over this element" */
        .btn-primary:hover {
            /* Move button up 2 pixels */
            transform: translateY(-2px);
            
            /* Add shadow: x y blur color */
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* Style buttons with class="btn-danger" (red buttons) */
        .btn-danger {
            background: #e74c3c;   /* Red background */
            color: white;          /* White text */
        }

        /* When hovering over danger buttons */
        .btn-danger:hover {
            background: #c0392b;   /* Darker red */
            transform: translateY(-2px);  /* Move up */
        }

        /* The white card that shows the question */
        .card-display {
            background: white;     /* White background */
            border-radius: 20px;   /* Rounded corners */
            padding: 40px;         /* Space inside the card */
            margin-bottom: 30px;   /* Space below the card */
            
            /* Shadow: x y blur spread color */
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            
            min-height: 200px;     /* At least 200px tall */
            
            /* Flexbox to center content */
            display: flex;
            align-items: center;      /* Center vertically */
            justify-content: center;  /* Center horizontally */
            text-align: center;       /* Center text inside */
        }

        /* Container for card content */
        .card-content {
            width: 100%;  /* Take up full width of parent */
        }

        /* The question text styling */
        .card-question {
            font-size: 1.5em;      /* 1.5 times normal size */
            color: #333;           /* Dark gray text */
            margin-bottom: 10px;   /* Space below */
        }

        /* The input box where user types their answer */
        .answer-input {
            width: 100%;           /* Full width */
            padding: 15px;         /* Space inside */
            font-size: 16px;       /* Text size */
            border: 2px solid #ddd;  /* Light gray border, 2px thick */
            border-radius: 10px;   /* Rounded corners */
            margin-bottom: 20px;   /* Space below */
            transition: border 0.3s;  /* Smooth border color change */
        }

        /* :focus means "when this input is clicked/selected" */
        .answer-input:focus {
            outline: none;         /* Remove default blue outline */
            border-color: #667eea; /* Change border to purple */
        }

        /* Container for the check/next buttons */
        .study-buttons {
            display: flex;         /* Flexbox layout */
            gap: 15px;            /* Space between buttons */
            justify-content: center;  /* Center buttons */
            margin-bottom: 20px;   /* Space below */
        }

        /* The result message (correct/wrong) */
        .result {
            text-align: center;    /* Center text */
            font-size: 1.2em;      /* Bigger text */
            font-weight: 600;      /* Bold */
            min-height: 30px;      /* Reserve space even when empty */
        }

        /* When result has class "correct" (right answer) */
        .correct {
            color: #27ae60;  /* Green color */
        }

        /* When result has class "wrong" (wrong answer) */
        .wrong {
            color: #e74c3c;  /* Red color */
        }

        /* Modal is a popup window that appears over the page */
        .modal {
            display: none;         /* Hidden by default */
            position: fixed;       /* Stay in place when scrolling */
            top: 0;               /* Start at top of screen */
            left: 0;              /* Start at left of screen */
            width: 100%;          /* Cover full width */
            height: 100%;         /* Cover full height */
            background: rgba(0,0,0,0.5);  /* Semi-transparent black overlay */
            z-index: 1000;        /* Appear above everything else */
        }

        /* The white box inside the modal */
        .modal-content {
            background: white;     /* White background */
            max-width: 500px;      /* Don't get wider than 500px */
            margin: 100px auto;    /* Center it, with 100px space from top */
            padding: 30px;         /* Space inside */
            border-radius: 20px;   /* Rounded corners */
            position: relative;    /* For positioning child elements */
        }

        /* Headings inside modals */
        .modal h2 {
            margin-bottom: 20px;   /* Space below heading */
            color: #333;           /* Dark gray text */
        }

        /* Input boxes inside modals */
        .modal input {
            width: 100%;           /* Full width */
            padding: 12px;         /* Space inside */
            margin-bottom: 15px;   /* Space below */
            border: 2px solid #ddd;  /* Light gray border */
            border-radius: 8px;    /* Rounded corners */
            font-size: 16px;       /* Text size */
        }

        /* Button container in modals */
        .modal-buttons {
            display: flex;         /* Flexbox layout */
            gap: 10px;            /* Space between buttons */
            justify-content: flex-end;  /* Push buttons to the right */
        }

        /* Scrollable list of cards in remove modal */
        .card-list {
            max-height: 400px;     /* Don't get taller than 400px */
            overflow-y: auto;      /* Add scrollbar if content is too tall */
        }

        /* Each card item in the list */
        .card-item {
            background: #f8f9fa;   /* Light gray background */
            padding: 15px;         /* Space inside */
            margin-bottom: 10px;   /* Space below */
            border-radius: 10px;   /* Rounded corners */
            display: flex;         /* Flexbox layout */
            justify-content: space-between;  /* Space between text and button */
            align-items: center;   /* Center items vertically */
        }

        /* Text part of card item */
        .card-item-text {
            flex: 1;              /* Take up available space */
            margin-right: 15px;   /* Space before button */
        }

        /* Smaller buttons */
        .btn-small {
            padding: 8px 15px;    /* Less padding than normal buttons */
            font-size: 14px;      /* Smaller text */
        }
    </style>
</head>

<!-- <body> contains everything visible on the page -->
<body>
    <!-- Main container that holds all content -->
    <div class="container">
        <!-- Main heading with emoji -->
        <h1>üìö Flashcard Study App</h1>
        
        <!-- Container for the top buttons -->
        <div class="top-buttons">
            <!-- Button to add a card - onclick runs JavaScript function when clicked -->
            <button class="btn-primary" onclick="openAddModal()">‚ûï Add Card</button>
            
            <!-- Button to remove a card -->
            <button class="btn-danger" onclick="openRemoveModal()">üóëÔ∏è Remove Card</button>
        </div>

        <!-- The white card that displays the question -->
        <div class="card-display">
            <div class="card-content">
                <!-- id="question" so JavaScript can change this text -->
                <div class="card-question" id="question">Press Next to Begin</div>
            </div>
        </div>

        <!-- Input where user types their answer -->
        <!-- id="answerInput" so JavaScript can get what user typed -->
        <!-- placeholder is gray text that shows when empty -->
        <input type="text" class="answer-input" id="answerInput" placeholder="Type your answer here...">

        <!-- Container for study buttons -->
        <div class="study-buttons">
            <!-- Check answer button -->
            <button class="btn-primary" onclick="checkAnswer()">‚úì Check Answer</button>
            
            <!-- Next card button -->
            <button class="btn-primary" onclick="nextCard()">‚Üí Next</button>
        </div>

        <!-- Shows "Correct!" or "Wrong!" after checking -->
        <!-- id="result" so JavaScript can change this -->
        <div class="result" id="result"></div>
    </div>

    <!-- POPUP MODAL for adding a card (hidden by default) -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <h2>Add New Flashcard</h2>
            
            <!-- Input for question -->
            <input type="text" id="newQuestion" placeholder="Question">
            
            <!-- Input for answer -->
            <input type="text" id="newAnswer" placeholder="Answer">
            
            <!-- Buttons in modal -->
            <div class="modal-buttons">
                <button class="btn-primary" onclick="saveCard()">Save</button>
                <button class="btn-danger" onclick="closeAddModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- POPUP MODAL for removing a card (hidden by default) -->
    <div class="modal" id="removeModal">
        <div class="modal-content">
            <h2>Remove Flashcard</h2>
            
            <!-- List of cards will be inserted here by JavaScript -->
            <div class="card-list" id="cardList"></div>
            
            <div class="modal-buttons">
                <button class="btn-danger" onclick="closeRemoveModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- <script> contains JavaScript - makes the page INTERACTIVE -->
    <script>
        // Create an empty array to store cards in the browser
        // This is separate from the Python cards list - this is browser-side only
        let cards = [];
        
        // Variable to track which card we're currently showing
        // 0 = first card, 1 = second card, etc.
        let currentIndex = 0;

        // Run loadCards() immediately when page loads
        loadCards();

        // Function to get all cards from the Python server
        function loadCards() {
            // fetch() makes a request to our Python server
            // '/get_cards' matches the @app.route('/get_cards') in Python
            fetch('/get_cards')
                // .then() means "when the response comes back, do this"
                // response.json() converts the response to JavaScript objects
                .then(response => response.json())
                // data is the cards array from Python
                .then(data => {
                    // Store the cards in our browser-side cards variable
                    cards = data;
                    
                    // If we have at least one card
                    if (cards.length > 0) {
                        // Start at the first card
                        currentIndex = 0;
                        // Show that card on screen
                        showCurrentCard();
                    }
                });
        }

        // Function to show the "Add Card" popup
        function openAddModal() {
            // document.getElementById finds an element by its id
            // .style.display = 'block' makes it visible
            document.getElementById('addModal').style.display = 'block';
        }

        // Function to close the "Add Card" popup
        function closeAddModal() {
            // Hide the modal
            document.getElementById('addModal').style.display = 'none';
            
            // Clear the input boxes
            document.getElementById('newQuestion').value = '';
            document.getElementById('newAnswer').value = '';
        }

        // Function to save a new card
        function saveCard() {
            // Get what user typed in question box
            // .value gets the text from an input
            const question = document.getElementById('newQuestion').value;
            
            // Get what user typed in answer box
            const answer = document.getElementById('newAnswer').value;

            // Only proceed if both have text
            if (question && answer) {
                // Send data to Python server
                fetch('/add_card', {
                    method: 'POST',  // POST means sending data TO server
                    
                    // Tell server we're sending JSON
                    headers: {'Content-Type': 'application/json'},
                    
                    // Convert JavaScript object to JSON string and send it
                    // JSON.stringify turns {question: "...", answer: "..."} into a string
                    body: JSON.stringify({question, answer})
                })
                // When server responds
                .then(response => response.json())
                // data is the response from Python (success: true/false)
                .then(data => {
                    // If Python said it worked
                    if (data.success) {
                        // Reload all cards from server
                        loadCards();
                        // Close the popup
                        closeAddModal();
                    }
                });
            }
        }

        // Function to show the "Remove Card" popup
        function openRemoveModal() {
            // If there are no cards
            if (cards.length === 0) {
                // Show a browser alert
                alert('No cards to remove!');
                return;  // Exit the function early
            }
            
            // Find the card list container
            const cardList = document.getElementById('cardList');
            
            // Clear any existing content (innerHTML = '' makes it empty)
            cardList.innerHTML = '';
            
            // Loop through each card
            // forEach runs the function for each item in the array
            // card is the current item, index is its position (0, 1, 2...)
            cards.forEach((card, index) => {
                // Create a new div element in memory
                const item = document.createElement('div');
                
                // Give it the card-item class (for styling)
                item.className = 'card-item';
                
                // Set its HTML content
                // Template literal (backticks) let us insert variables with ${}
                // ${card.question} inserts the question text
                // ${index} inserts the card number
                item.innerHTML = `
                    <div class="card-item-text">
                        <strong>Q:</strong> ${card.question}
                    </div>
                    <button class="btn-danger btn-small" onclick="removeCard(${index})">Remove</button>
                `;
                
                // Add this item to the cardList container
                cardList.appendChild(item);
            });
            
            // Show the remove modal
            document.getElementById('removeModal').style.display = 'block';
        }

        // Function to close the remove popup
        function closeRemoveModal() {
            document.getElementById('removeModal').style.display = 'none';
        }

        // Function to remove a card at a specific index
        function removeCard(index) {
            // Send request to Python server to remove this card
            fetch('/remove_card', {
                method: 'POST',  // POST because we're sending data
                headers: {'Content-Type': 'application/json'},
                
                // Send the index of the card to remove
                body: JSON.stringify({index})
            })
            .then(response => response.json())
            .then(data => {
                // If Python successfully removed it
                if (data.success) {
                    // Reload all cards from server
                    loadCards();
                    // Close the popup
                    closeRemoveModal();
                }
            });
        }

        // Function to display the current card on screen
        function showCurrentCard() {
            // If there are no cards
            if (cards.length === 0) {
                // Show a message
                document.getElementById('question').textContent = 'No cards yet! Add some cards to start studying.';
                return;  // Exit function
            }
            
            // Get the current card from the array
            // cards[currentIndex] gets the card at position currentIndex
            // .textContent changes the text inside an element
            document.getElementById('question').textContent = cards[currentIndex].question;
            
            // Clear the answer input box
            document.getElementById('answerInput').value = '';
            
            // Clear the result message
            document.getElementById('result').textContent = '';
        }

        // Function to check if user's answer is correct
        function checkAnswer() {
            // Don't do anything if there are no cards
            if (cards.length === 0) return;
            
            // Get what user typed
            // .trim() removes extra spaces from start and end
            const userAnswer = document.getElementById('answerInput').value.trim();
            
            // Get the correct answer from current card
            const correctAnswer = cards[currentIndex].answer;
            
            // Find the result div
            const resultDiv = document.getElementById('result');
            
            // === checks if two values are exactly equal
            if (userAnswer === correctAnswer) {
                // Show correct message
                resultDiv.textContent = '‚úì Correct!';
                // Add the 'correct' class (makes it green)
                resultDiv.className = 'result correct';
            } else {
                // Show wrong message with correct answer
                resultDiv.textContent = `‚úó Wrong! Answer: ${correctAnswer}`;
                // Add the 'wrong' class (makes it red)
                resultDiv.className = 'result wrong';
            }
        }

        // Function to move to next card
        function nextCard() {
            // Don't do anything if no cards
            if (cards.length === 0) return;
            
            // Move to next card
            // (currentIndex + 1) adds 1 to current position
            // % cards.length wraps back to 0 when reaching the end
            // Example: if cards.length is 5 and currentIndex is 4,
            // (4 + 1) % 5 = 5 % 5 = 0 (goes back to first card)
            currentIndex = (currentIndex + 1) % cards.length;
            
            // Show the new card
            showCurrentCard();
        }
    </script>
</body>
</html>